
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../getting-started/">
      
      
        <link rel="next" href="../api-reference/">
      
      
      <link rel="icon" href="../../img/logo/cube_small.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.44">
    
    
      
        <title>Example Use Case - DeepESDL Documentation (in development)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/mkapi-common.css">
    
      <link rel="stylesheet" href="../../css/mkapi-material.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#example-use-cases" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DeepESDL Documentation (in development)" class="md-header__button md-logo" aria-label="DeepESDL Documentation (in development)" data-md-component="logo">
      
  <img src="../../img/logo/cube_small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DeepESDL Documentation (in development)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Example Use Case
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="pink"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/deepesdl/deepesdl-doc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DeepESDL Documentation (in development)" class="md-nav__button md-logo" aria-label="DeepESDL Documentation (in development)" data-md-component="logo">
      
  <img src="../../img/logo/cube_small.png" alt="logo">

    </a>
    DeepESDL Documentation (in development)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/deepesdl/deepesdl-doc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About DeepESDL
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            About DeepESDL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/summary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Summary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/events_announcements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    News and Announcements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/change_log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Change Log
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Platform Design
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Platform Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Context
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/hub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/services-and-tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Services and Tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/jupyterlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JupyterLab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Visualisation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Visualisation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/xcube-viewer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xcube Viewer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/lexcube-viewer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lexcube Viewer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/4d-viewer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4D Viewer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/datacubes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datacubes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/datacube-generation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datacube generation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" checked>
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ML Toolkits
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            ML Toolkits
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/ml-toolkits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Example Use Case
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Example Use Case
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Example Use Cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-land-surface-temperature-prediction" class="md-nav__link">
    <span class="md-ellipsis">
      1. Land Surface Temperature prediction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Land Surface Temperature prediction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demo-notebooks" class="md-nav__link">
    <span class="md-ellipsis">
      Demo Notebooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approach" class="md-nav__link">
    <span class="md-ellipsis">
      Approach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preliminary-condition" class="md-nav__link">
    <span class="md-ellipsis">
      Preliminary Condition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machine-learning-approach" class="md-nav__link">
    <span class="md-ellipsis">
      Machine Learning Approach
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Machine Learning Approach">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-load-earth-system-data-cube" class="md-nav__link">
    <span class="md-ellipsis">
      1. Load Earth System Data Cube
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-land-mask-variable" class="md-nav__link">
    <span class="md-ellipsis">
      2. Add land mask variable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-train-test-split-on-geo-data" class="md-nav__link">
    <span class="md-ellipsis">
      3. Train-/ Test Split on Geo-Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-train-and-test-set-creation-and-preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      4. Train-/ and Test Set Creation and Preprocessing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-model-setup-optimizer-and-loss-definition" class="md-nav__link">
    <span class="md-ellipsis">
      5. Model Setup, Optimizer and Loss Definition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-model-training-and-validation" class="md-nav__link">
    <span class="md-ellipsis">
      6. Model Training and Validation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      Model Tracking
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-distributed-machine-learning" class="md-nav__link">
    <span class="md-ellipsis">
      2. Distributed Machine Learning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Distributed Machine Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demo-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      Demo Scripts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Demo Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Data Preparation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-transfer-learning" class="md-nav__link">
    <span class="md-ellipsis">
      3. Transfer Learning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Transfer Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demo-notebook" class="md-nav__link">
    <span class="md-ellipsis">
      Demo Notebook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-cube-insights" class="md-nav__link">
    <span class="md-ellipsis">
      4. Cube Insights
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Cube Insights">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demo-notebook_1" class="md-nav__link">
    <span class="md-ellipsis">
      Demo Notebook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-gapfilling" class="md-nav__link">
    <span class="md-ellipsis">
      5. Gapfilling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Gapfilling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demo-notebook_2" class="md-nav__link">
    <span class="md-ellipsis">
      Demo Notebook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-predictions-for-multidimensional-samples" class="md-nav__link">
    <span class="md-ellipsis">
      6. Predictions for Multidimensional Samples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Predictions for Multidimensional Samples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demo-notebooks_1" class="md-nav__link">
    <span class="md-ellipsis">
      Demo Notebooks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/further-information/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Further information
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Catalogue/ Datasets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Catalogue/ Datasets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List of datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/datastores/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xcube Data Stores
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/ESDC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Earth System Data Cube
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/black-sea/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Black Sea Cube
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/LC-1x2025x2025-2-0-0-levels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Land Cover Cube
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/ocean-1M-9km-1x1080x1080-1-4-0-zarr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ocean Cube
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/SMOS-snow-1x720x720-1-0-1-zarr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SMOS freeze/thaw Cube
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/polar-100m-1x2048x2048-1-0-1-zarr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polar Cube
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/esa-cci-permafrost-1x1151x1641-0-0-2-zarr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Permafrost Cube
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/hydrology-1D-0-009deg-100x60x60-3-0-2-zarr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hydrology Cube
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Science Cases
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Science Cases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../science_cases/case_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SC#1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../science_cases/case_n/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SC#n
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../research/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Reproducible Research
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Reproducible Research
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research/instructions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Instructions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research/example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../become_user/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Become a User
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../stories/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Success Stories
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Success Stories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stories/list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project List
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dissemination
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Dissemination
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dissemination/events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Events
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dissemination/publications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Publications
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Example Use Cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-land-surface-temperature-prediction" class="md-nav__link">
    <span class="md-ellipsis">
      1. Land Surface Temperature prediction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Land Surface Temperature prediction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demo-notebooks" class="md-nav__link">
    <span class="md-ellipsis">
      Demo Notebooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approach" class="md-nav__link">
    <span class="md-ellipsis">
      Approach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preliminary-condition" class="md-nav__link">
    <span class="md-ellipsis">
      Preliminary Condition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machine-learning-approach" class="md-nav__link">
    <span class="md-ellipsis">
      Machine Learning Approach
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Machine Learning Approach">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-load-earth-system-data-cube" class="md-nav__link">
    <span class="md-ellipsis">
      1. Load Earth System Data Cube
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-land-mask-variable" class="md-nav__link">
    <span class="md-ellipsis">
      2. Add land mask variable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-train-test-split-on-geo-data" class="md-nav__link">
    <span class="md-ellipsis">
      3. Train-/ Test Split on Geo-Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-train-and-test-set-creation-and-preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      4. Train-/ and Test Set Creation and Preprocessing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-model-setup-optimizer-and-loss-definition" class="md-nav__link">
    <span class="md-ellipsis">
      5. Model Setup, Optimizer and Loss Definition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-model-training-and-validation" class="md-nav__link">
    <span class="md-ellipsis">
      6. Model Training and Validation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      Model Tracking
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-distributed-machine-learning" class="md-nav__link">
    <span class="md-ellipsis">
      2. Distributed Machine Learning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Distributed Machine Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demo-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      Demo Scripts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Demo Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Data Preparation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-transfer-learning" class="md-nav__link">
    <span class="md-ellipsis">
      3. Transfer Learning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Transfer Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demo-notebook" class="md-nav__link">
    <span class="md-ellipsis">
      Demo Notebook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-cube-insights" class="md-nav__link">
    <span class="md-ellipsis">
      4. Cube Insights
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Cube Insights">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demo-notebook_1" class="md-nav__link">
    <span class="md-ellipsis">
      Demo Notebook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-gapfilling" class="md-nav__link">
    <span class="md-ellipsis">
      5. Gapfilling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Gapfilling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demo-notebook_2" class="md-nav__link">
    <span class="md-ellipsis">
      Demo Notebook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-predictions-for-multidimensional-samples" class="md-nav__link">
    <span class="md-ellipsis">
      6. Predictions for Multidimensional Samples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Predictions for Multidimensional Samples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demo-notebooks_1" class="md-nav__link">
    <span class="md-ellipsis">
      Demo Notebooks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Example Use Case</h1>

<h2 id="example-use-cases">Example Use Cases<a class="headerlink" href="#example-use-cases" title="Permanent link">#</a></h2>
<p>This toolkit provides a series of tutorial notebooks designed to support geospatial data processing and machine learning 
tasks on Earth System Data Cubes (ESDCs). Key use cases include:</p>
<ol>
<li>
<p><strong><a href="#1-land-surface-temperature-prediction">Land Surface Temperature Prediction</a></strong>: Demonstrates land surface temperature prediction. This serves as an introductory example for ESDC analysis.</p>
</li>
<li>
<p><strong><a href="#2-distributed-machine-learning">Distributed Machine Learning</a></strong>: Showcases efficient preparation and training of large datasets on distributed systems.</p>
</li>
<li>
<p><strong><a href="#3-transfer-learning">Transfer Learning</a></strong>: Illustrates how to reuse pre-trained models for related tasks with limited data.</p>
</li>
<li>
<p><strong><a href="#4-cube-insights">Cube Insights</a></strong>: Explores the characteristics of data cubes, helping inform preprocessing and modeling decisions.</p>
</li>
<li>
<p><strong><a href="#5-gapfilling">Gap Filling</a></strong>: Provides techniques to fill missing data in remote sensing datasets using support vector regression (SVR).</p>
</li>
<li>
<p><strong><a href="#6-coastal-predictions-for-multidimensional-samples">ML for Multidimensional Samples with missing values</a></strong>: Demonstrates predictions on multidimensional data, utilizing simpler data imputation methods to address gaps.</p>
</li>
</ol>
<p>Each of these use cases is accompanied by a corresponding Jupyter notebook/Python script, providing step-by-step 
instructions, code examples, and visualizations to guide users through the entire workflow. Whether you're looking 
to explore your data, fill gaps, or train machine learning models, this toolkit offers a set of resources to help 
you achieve your goals.</p>
<h3 id="1-land-surface-temperature-prediction">1. Land Surface Temperature prediction<a class="headerlink" href="#1-land-surface-temperature-prediction" title="Permanent link">#</a></h3>
<p>This generic use case aims at the prediction of land surface temperature 
values based on air temperature values derived from the ESDC 
(Sentinel 3 SLSTR and Terra MODIS sensor, s3 store). </p>
<p>Satellite monitoring is highly sensitive to atmospheric conditions, in 
particular to cloud cover, leading to the loss of a significant part of data,
especially at high latitudes. This may even affect some pixels of an image 
which are not cloudy, but strongly influenced by cloud cover, usually 
because they were cloudy shortly before the moment of sensing or because of 
cloud shadows (Sarafanov et al. 2020).
Therefore, remotely sensed land surface temperature images are patchy and 
gaps need to be filled in to complete the data set. 
Here, we propose a shallow neural network (Linear Regression) to predict 
missing values of land surface temperature from consistent air 
temperature values.</p>
<p align="center">
<img src="../../img/xcubeviewer3.png" width="35%" height="35%">
</p>
<p align = "center"><i><strong>
ML prediction of missing Land Surface Temperature values from Air Temperature values (xcube viewer)</strong></i>
</p>

<h4 id="demo-notebooks">Demo Notebooks<a class="headerlink" href="#demo-notebooks" title="Permanent link">#</a></h4>
<p>All Jupyter Notebooks follow the same approach, involving five major sections supported by markdown cells, comments, 
and plots:</p>
<ol>
<li><a href="https://github.com/deepesdl/ML-Toolkits/blob/master/Examples/use_case_lst_at_scikit-learn_mlflow.ipynb">Landsurface Temperature Prediction <em>scikit-learn</em></a></li>
<li><a href="https://github.com/deepesdl/ML-Toolkits/blob/master/Examples/use_case_lst_at_pytorch_mlflow.ipynb">Landsurface Temperature Prediction <em>PyTorch</em></a></li>
<li><a href="https://github.com/deepesdl/ML-Toolkits/blob/master/Examples/use_case_lst_at_tensorflow_tensorboard.ipynb">Landsurface Temperature Prediction <em>TensorFlow</em></a></li>
</ol>
<h4 id="approach">Approach<a class="headerlink" href="#approach" title="Permanent link">#</a></h4>
<ol>
<li>Import necessary libraries and mltools</li>
<li>Load Earth System Data Cube (s3 object store) </li>
<li>Initialize data mask</li>
<li>Assign train/test split</li>
<li>Preprocessing (filtering NaNs, standardization, normalization)</li>
<li>Model set-up (linear regression with 1 node/ shallow neural network)</li>
<li>Model training and validation over a number of epochs:<ul>
<li>Training:<ul>
<li>Generate training batches using existing data loading and transformation mechanisms from Keras and PyTorch (DataGenerator, DataLoader)</li>
<li>Train model, and compute average epoch training loss</li>
</ul>
</li>
<li>Validation:<ul>
<li>Generate testing batches using existing data loading and transformation mechanisms from Keras and PyTorch (DataGenerator, DataLoader)</li>
<li>Test model, and compute average epoch validation loss</li>
</ul>
</li>
</ul>
</li>
<li>Use model to make predictions &amp; plot results</li>
</ol>
<p align="center">
<img src="../../img/mltoolkit_scheme.png" width="30%" height="32%">
</p>
<p align = "center"><i><strong>
Machine Learning workflow on Analysis Ready Data Cubes</strong></i>
</p>

<h4 id="preliminary-condition">Preliminary Condition<a class="headerlink" href="#preliminary-condition" title="Permanent link">#</a></h4>
<p>As initially described in the <a href="#demo-notebooks">demo cases</a>, the missing values of land surface temperature 
are predicted from consistent air temperature values.</p>
<table align="center" style="border-collapse: collapse; margin: 0 auto;">
  <tr>
    <td width="50%" style="border: none; text-align: center;">
      <img src="../at.png" width="lst.png"/><br/>
      <i><strong>Air Temperature</strong> </i>
    </td>
    <td width="50%" style="border: none; text-align: center;">
      <img src="../lst.png" width="100%"/><br/>
      <i><strong>Land Surface Temperature</strong> </i>
    </td>
  </tr>
</table>

<h4 id="machine-learning-approach">Machine Learning Approach<a class="headerlink" href="#machine-learning-approach" title="Permanent link">#</a></h4>
<p>In this section, the machine learning approach is briefly illustrated based on the
<a href="https://github.com/deepesdl/ML-Toolkits/blob/master/Examples/use_case_lst_at_tensorflow_tensorboard.ipynb">TenorFlow notebook</a>.
For comprehensive implementations, refer to the  <a href="#demo-notebooks">demo notebooks</a> to see the full implementations.</p>
<h6 id="1-load-earth-system-data-cube">1. Load Earth System Data Cube<a class="headerlink" href="#1-load-earth-system-data-cube" title="Permanent link">#</a></h6>
<p>First, the <code>zarr</code> data cube is loaded from the s3 data store. The ESDC consists of three dimensions: longitude, 
latitude, and time. The focus will be on two variables: "land_surface_temperature" and "air_temperature_2m".</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">xcube.core.store</span> <span class="kn">import</span> <span class="n">new_data_store</span>

<span class="c1"># Initialize the data store for accessing the s3 bucket</span>
<span class="n">data_store</span> <span class="o">=</span> <span class="n">new_data_store</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="s2">&quot;esdl-esdc-v2.1.1&quot;</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">anon</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># Open the dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">data_store</span><span class="o">.</span><span class="n">open_data</span><span class="p">(</span><span class="s2">&quot;esdc-8d-0.083deg-184x270x270-2.1.1.zarr&quot;</span><span class="p">)</span>

<span class="c1"># Select a smaller subset of the data for this demo case</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="s2">&quot;2002-05-21&quot;</span>
<span class="n">end_time</span> <span class="o">=</span> <span class="s2">&quot;2002-08-01&quot;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s2">&quot;land_surface_temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;air_temperature_2m&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">))</span>
</code></pre></div>
<h5 id="2-add-land-mask-variable">2. Add land mask variable<a class="headerlink" href="#2-add-land-mask-variable" title="Permanent link">#</a></h5>
<p>Fir the prediction of the land surface temperature values only terrestrial regions are relevant.
Therefore, a land variable is assigned to the ESDC to exclude the oceanic regions. </p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">dask.array</span> <span class="k">as</span> <span class="nn">da</span>
<span class="kn">from</span> <span class="nn">global_land_mask</span> <span class="kn">import</span> <span class="n">globe</span>
<span class="kn">from</span> <span class="nn">ml4xcube.preprocessing</span> <span class="kn">import</span> <span class="n">assign_mask</span>

<span class="n">lon_grid</span><span class="p">,</span> <span class="n">lat_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span><span class="n">ds</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
<span class="n">lm0</span>                <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">globe</span><span class="o">.</span><span class="n">is_land</span><span class="p">(</span><span class="n">lat_grid</span><span class="p">,</span> <span class="n">lon_grid</span><span class="p">))</span>
<span class="n">xdsm</span>               <span class="o">=</span> <span class="n">assign_mask</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lm0</span><span class="p">)</span> 
<span class="n">xdsm</span>
</code></pre></div>
<h5 id="3-train-test-split-on-geo-data">3. Train-/ Test Split on Geo-Data<a class="headerlink" href="#3-train-test-split-on-geo-data" title="Permanent link">#</a></h5>
<p>The <code>ml4xcube.splits</code> module provides two methods to split the data into training and test sets: 
random split and block split.</p>
<p><strong>1. Random Split</strong></p>
<p>The random split is a straight forward procedure in classical machine learning application to divide data in 
a train and a test set.
Every data sample is assigned randomly with a predefined probability either to 
the train or the test. 
This approach can lead to issues due to spatio-temporal distances and auto-correlation within chunks.</p>
<p><strong>2. Block Split</strong></p>
<p>It is therefore mandatory to utilize techniques that respects the basic 
principles of geo-data way beyond naive random split method in 
the Earth system context. To avoid auto-correlation during the training 
phase of the model, data splitting should rather be guided by the block 
split strategy, which segments data
into contiguous blocks based on geographical and temporal
proximity, assigning data points from these blocks to either
training or test sets with a specific probability. This strategy keeps 
closely related data points together, reducing information leakage 
across the train-test divide and enhancing
testing integrity.</p>
<table align="center" style="border-collapse: collapse; margin: 0 auto;">
  <tr>
    <td width="50%" style="border: none; text-align: center;">
      <img src="../train_test_assignment_rnd.png" width="100%"/><br/>
      <i><strong>Random Train-Test Assignment</strong> </i>
    </td>
    <td width="50%" style="border: none; text-align: center;">
      <img src="../train_test_assignment_bs.png" width="100%"/><br/>
      <i><strong>Balanced Stratified Train-Test Assignment</strong> </i>
    </td>
  </tr>
</table>

<p>For this case, the <code>assign_block_split</code> method is employed to allocate each data point to either the training or test set:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">ml4xcube.splits</span> <span class="kn">import</span> <span class="n">assign_rand_split</span><span class="p">,</span> <span class="n">assign_block_split</span>

<span class="c1"># random splitting</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">xds = assign_rand_split(</span>
<span class="sd">    ds    = xdsm,</span>
<span class="sd">    split = 0.8</span>
<span class="sd">)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># block splitting</span>
<span class="n">xds</span> <span class="o">=</span> <span class="n">assign_block_split</span><span class="p">(</span>
    <span class="n">ds</span>         <span class="o">=</span> <span class="n">xdsm</span><span class="p">,</span>
    <span class="n">block_size</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)],</span>
    <span class="n">split</span>      <span class="o">=</span> <span class="mf">0.8</span>
<span class="p">)</span>
<span class="n">xds</span>
</code></pre></div></p>
<h5 id="4-train-and-test-set-creation-and-preprocessing">4. Train-/ and Test Set Creation and Preprocessing<a class="headerlink" href="#4-train-and-test-set-creation-and-preprocessing" title="Permanent link">#</a></h5>
<p>In this step, data is preprocessed for training using the designated sampler. The dataset undergoes standardization and 
is segmented into manageable samples. The feature scaling strategy can be customized via the <code>scale_fn</code> parameter, which 
allows for normalization or can be set to None for manual adjustments. If <code>None</code>, a custom feature scaling function can be 
introduced using the <code>callback parameter</code>, enabling further preprocessing flexibility with costum functions.</p>
<p>By default, missing values are omitted from the dataset. To apply alternative imputation strategies, adjust the <code>drop_nan</code> 
parameter of the <code>XrDataset</code>. For comprehensive guidance on these options, please consult the 
<a href="../api-reference/#6-datasets">ml4xcube API description</a> description.</p>
<p>Following preprocessing, the data is allocated into training and testing sets based on the previously determined block 
split strategy, ensuring readiness for the subsequent training phase.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">ml4xcube.datasets.xr_dataset</span> <span class="kn">import</span> <span class="n">XrDataset</span>

<span class="n">sampler</span>               <span class="o">=</span> <span class="n">XrDataset</span><span class="p">(</span><span class="n">ds</span><span class="o">=</span><span class="n">xds</span><span class="p">,</span> <span class="n">num_chunks</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rand_chunk</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">to_pred</span><span class="o">=</span><span class="s1">&#39;land_surface_temperature&#39;</span><span class="p">)</span>
<span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">get_datasets</span><span class="p">()</span>

<span class="c1"># Create TensorFlow 6-datasets for 7-training and testing</span>
<span class="n">train_ds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="n">test_ds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
</code></pre></div>
<h5 id="5-model-setup-optimizer-and-loss-definition">5. Model Setup, Optimizer and Loss Definition<a class="headerlink" href="#5-model-setup-optimizer-and-loss-definition" title="Permanent link">#</a></h5>
<p>A simple linear regression model using TensorFlow is defined, followed by the setup of the optimizer and the loss function definition.
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">layers</span> <span class="k">as</span> <span class="n">L</span>

<span class="c1"># Define epoch and learning rate</span>
<span class="n">lr</span>     <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Create model</span>
<span class="n">inputs</span>      <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;air_temperature_2m&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
<span class="n">output</span>      <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;land_surface_temperature&quot;</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">model</span>       <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">output</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;adam&quot;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;mean_squared_error&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mae&quot;</span><span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">learning_rate</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">lr</span><span class="p">)</span>
</code></pre></div></p>
<h5 id="6-model-training-and-validation">6. Model Training and Validation<a class="headerlink" href="#6-model-training-and-validation" title="Permanent link">#</a></h5>
<p>Finally, the model is trained using <code>train_ds</code> and validated with the <code>test_ds</code> dataset. Early stopping is employed to 
prevent overfitting. The best model weights, according to the validation score, are saved, and the trained model is 
returned, ready for predictions.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">ml4xcube.training.tensorflow</span> <span class="kn">import</span> <span class="n">Trainer</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">train_data</span><span class="o">=</span><span class="n">train_ds</span><span class="p">,</span>
    <span class="n">test_data</span><span class="o">=</span><span class="n">test_ds</span><span class="p">,</span>
    <span class="n">early_stopping</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">model_path</span><span class="o">=</span><span class="s2">&quot;best_model.keras&quot;</span><span class="p">,</span>
    <span class="n">mlflow_run</span><span class="o">=</span><span class="n">mlflow</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
    <span class="n">create_loss_plot</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</code></pre></div>
<h4 id="results">Results<a class="headerlink" href="#results" title="Permanent link">#</a></h4>
<p>After conducting the entire <a href="#approach">machine learning approach</a> 
the trained model can be used to make predictions for the missing land surface temperature values:</p>
<p align="center">
<img src="../lst_filled.png" width="55%" height="35%">
</p>
<p align = "center"><i>
<strong>Land Surface Temperature Filled</strong></i>
</p>

<h4 id="model-tracking">Model Tracking<a class="headerlink" href="#model-tracking" title="Permanent link">#</a></h4>
<p>Within the land surface temperature use cases model tracking is realized through the usage of <a href="https://www.tensorflow.org/tensorboard">TensorBoard</a> and 
<a href="https://mlflow.org/">mlflow</a>. These tools offer science teams an easy-to-use platform allowing to run and scale their Machine Learning workloads in a collaborative environment supporting versioning and sharing of parameters, models, artefacts, results, etc. within the team and potentially external users.
Mlflow supports the MLOps pipelines particularly to log and evaluate experiment runs as well as to store models in a registry​. Persistent mlflow deployments are made available on team level to allow each team member to compare their experiments with those of the other team members and to use the trained models of others.
TensorBoard as another collaborative tool in this MLOPs space is currently evaluated by the science teams and available as part of the TensorFlow conda kernel to individual users within their JupyterLab session.</p>
<p align="center">
<img src="../mlflow.png" width="85%" height="85%">
</p>
<p align = "center"><i>
<strong>Collaborative Experiment Tracking with mlflow.</strong></i>
</p>

<h3 id="2-distributed-machine-learning">2. Distributed Machine Learning<a class="headerlink" href="#2-distributed-machine-learning" title="Permanent link">#</a></h3>
<p>Satellites continuously monitor various Earth parameters across, generating vast amounts of data ideal for training sophisticated machine learning models. 
However, preparing and training with such large datasets can be time-consuming and resource-intensive.
The <code>ml4xcube</code> package facilitates efficient handling, preparation, and distributed training of large geospatial datasets, providing tools and workflows 
designed to optimize these processes.
Below are demonstrations on efficient dataset preparation (4) and distributed machine learning (5).
For simplicity the <a href="#1-land-surface-temperature-prediction">previous setup</a> is leveraged to illustrate the functionality.</p>
<h4 id="demo-scripts">Demo Scripts<a class="headerlink" href="#demo-scripts" title="Permanent link">#</a></h4>
<ol>
<li><a href="https://github.com/deepesdl/ML-Toolkits/blob/master/Examples/distributed_dataset_creation.py">Distributed Dataset Creation</a>. </li>
<li><a href="https://github.com/deepesdl/ML-Toolkits/blob/master/Examples/distributed_training.py">Distributed Machine Learning</a>. </li>
</ol>
<h5 id="data-preparation">Data Preparation<a class="headerlink" href="#data-preparation" title="Permanent link">#</a></h5>
<p>Before training machine learning models, data must be preprocessed and organized. This snippet is crucial for understanding how data, particularly large and 
complex datasets like those from satellites, is preprocessed before being used for machine learning. It demonstrates loading the data, computing statistics 
necessary for normalization, and applying these statistics to standardize the data with the help of a callback function. The callback function is used to apply 
transformations on-the-fly to each data chunk, ensuring that all data is processed uniformly. Further custom preprocessing steps can be added  accordingly.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">ml4xcube.preprocessing</span> <span class="kn">import</span> <span class="n">get_statistics</span><span class="p">,</span> <span class="n">standardize</span>
<span class="kn">from</span> <span class="nn">ml4xcube.datasets.multiproc_sampler</span> <span class="kn">import</span> <span class="n">MultiProcSampler</span>

<span class="c1"># Load sample data</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_zarr</span><span class="p">(</span><span class="s1">&#39;sample_data.zarr&#39;</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span>

<span class="c1"># Create a train and a test set and save them as train.zarr and test.zarr</span>
<span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span> <span class="o">=</span> <span class="n">MultiProcSampler</span><span class="p">(</span>
    <span class="n">ds</span>          <span class="o">=</span> <span class="n">ds</span><span class="p">,</span>
    <span class="n">train_cube</span>  <span class="o">=</span> <span class="s1">&#39;train.zarr&#39;</span><span class="p">,</span>
    <span class="n">test_cube</span>   <span class="o">=</span> <span class="s1">&#39;test.zarr&#39;</span><span class="p">,</span>
    <span class="n">nproc</span>       <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">chunk_batch</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">get_datasets</span><span class="p">()</span>
</code></pre></div>
<p>In the next step, the environment for training must be prepared by converting datasets to a format compatible with PyTorch, setting up a basic neural network model, and configuring 
the training process. Since in this example 1D data points are utilized for training, the dimension names assigned correspond to a 1D Tuple as well.
If the usage of multidimensional data samples is intended, please define the parameter sample_size of the <code>MultiProcSampler</code> class (e.g. <code>sample_size=[('time', 1), ('lat', 3), ('lon', 3)]</code>).
Overlapping samples are also possible (<code>overlap=[('time', 0.), ('lat', 0.33), ('lon', 0.33)]</code>). For further details check out the corresponding definition in the <a href="../api-reference/6-datasets/multiproc-sampler/">ml4xcube API</a>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">zarr</span> 
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">dask.array</span> <span class="k">as</span> <span class="nn">da</span>
<span class="kn">from</span> <span class="nn">ml4xcube.datasets.pytorch</span> <span class="kn">import</span> <span class="n">PTXrDataset</span>

<span class="k">def</span> <span class="nf">load_train_objs</span><span class="p">():</span>
    <span class="n">train_store</span> <span class="o">=</span> <span class="n">zarr</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;train.zarr&#39;</span><span class="p">)</span>
    <span class="n">test_store</span> <span class="o">=</span> <span class="n">zarr</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;test.zarr&#39;</span><span class="p">)</span>

    <span class="n">train_set</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>
    <span class="n">test_set</span>  <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># Create PyTorch data sets</span>
    <span class="n">train_ds</span> <span class="o">=</span> <span class="n">PTXrDataset</span><span class="p">(</span><span class="n">train_set</span><span class="p">)</span>
    <span class="n">test_ds</span>  <span class="o">=</span> <span class="n">PTXrDataset</span><span class="p">(</span><span class="n">test_set</span><span class="p">)</span>

    <span class="c1"># Initialize model and optimizer</span>
    <span class="n">model</span>     <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">loss</span>      <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">train_ds</span><span class="p">,</span> <span class="n">test_ds</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">loss</span>
</code></pre></div>
This final snippet sets up and runs the distributed training process using PyTorch. It includes initializing the distributed data parallel training environment, preparing data 
loaders with parallel processing capabilities, and defining the training loop. This approach significantly enhances the training efficiency on large-scale datasets by leveraging 
multiple processing units.
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">ml4xcube.datasets.pytorch</span> <span class="kn">import</span> <span class="n">prepare_dataloader</span>
<span class="kn">from</span> <span class="nn">ml4xcube.training.pytorch_distributed</span> <span class="kn">import</span> <span class="n">ddp_init</span><span class="p">,</span> <span class="n">Trainer</span><span class="p">,</span> <span class="n">dist_train</span>

<span class="c1"># Initialize distributed data parallel training</span>
<span class="n">ddp_init</span><span class="p">()</span>

<span class="c1"># Load training objects</span>
<span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">load_train_objs</span><span class="p">()</span>

<span class="c1"># Prepare data loaders</span>
<span class="n">train_loader</span><span class="p">,</span> <span class="n">test_loader</span> <span class="o">=</span> <span class="n">prepare_dataloader</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Initialize the trainer and start training</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
    <span class="n">model</span>                <span class="o">=</span> <span class="n">model</span><span class="p">,</span>
    <span class="n">train_data</span>           <span class="o">=</span> <span class="n">train_loader</span><span class="p">,</span>
    <span class="n">test_data</span>            <span class="o">=</span> <span class="n">test_loader</span><span class="p">,</span>
    <span class="n">optimizer</span>            <span class="o">=</span> <span class="n">optimizer</span><span class="p">,</span>
    <span class="n">save_every</span>           <span class="o">=</span> <span class="n">save_every</span><span class="p">,</span>
    <span class="n">model_path</span>           <span class="o">=</span> <span class="n">best_model_path</span><span class="p">,</span>
    <span class="n">early_stopping</span>       <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">patience</span>             <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">loss</span>                 <span class="o">=</span> <span class="n">loss</span><span class="p">,</span>
    <span class="n">validate_parallelism</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span>
</code></pre></div></p>
<h3 id="3-transfer-learning">3. Transfer Learning<a class="headerlink" href="#3-transfer-learning" title="Permanent link">#</a></h3>
<p>Transfer learning corresponds to a way to reuse information obtained by previous model training for a second related 
task. This can be necessary when only a concise amount of data is available. Therefore, a PyTorch based Jupyter 
Notebook provides the implementation of Transfer Learning. This technique was illustrated  for the same setting as the 
<a href="#1-land-surface-temperature-prediction">first example</a>, predicting missing land surface temperature values.</p>
<h4 id="demo-notebook">Demo Notebook<a class="headerlink" href="#demo-notebook" title="Permanent link">#</a></h4>
<ol>
<li><a href="https://github.com/deepesdl/ML-Toolkits/blob/master/Examples/transfer_learning.ipynb">Transfer Learning</a>. </li>
</ol>
<p align="center">
<img src="../transfer_learning.png" width="75%" height="75%">
</p>
<p align = "center"><i>
<strong>The Basic Concept of Transfer Learning.</strong></i>
</p>

<h3 id="4-cube-insights">4. Cube Insights<a class="headerlink" href="#4-cube-insights" title="Permanent link">#</a></h3>
<p>In order to decide which preprocessing steps are required by your machine learning application, the <code>insights</code> module 
offers tools for extracting and analyzing characteristics of an <code>xarray.DataArray</code> object. This module includes 
functions to assess the completeness and distribution of data within the cube.</p>
<h4 id="demo-notebook_1">Demo Notebook<a class="headerlink" href="#demo-notebook_1" title="Permanent link">#</a></h4>
<p>The corresponding Jupyter notebook containing the entire workflow can be accessed here:</p>
<ol>
<li><a href="https://github.com/deepesdl/ML-Toolkits/blob/master/Examples/cube_insights.ipynb">Landsurface Temperature Insights</a></li>
</ol>
<p>The detailed workflow in order to analyze the specifics of a data cube is demonstrated in the following:</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">ml4xcube.insights</span> <span class="kn">import</span> <span class="n">get_insights</span>

<span class="c1"># Load sample data</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_zarr</span><span class="p">(</span><span class="s1">&#39;sample_data.zarr&#39;</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span>

<span class="c1"># Get insights from the data cube</span>
<span class="n">get_insights</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
</code></pre></div>
The <code>get_insights</code> function, prints the following statistics (example for a cube containing dimensions named time, latitude, and longitude):</p>
<div class="highlight"><pre><span></span><code>100%|████████████████████| 10/10 [00:09&lt;00:00,  1.10it/s]
The data cube has the following characteristics:

Variable:             Land Surface Temperature
Shape:                (time: 10, lat: 2160, lon: 4320)
Time range:           2002-05-21 - 2002-08-01
Latitude range:       -89.958° - 89.958°
Longitude range:      -179.958° - 179.958°
Total size:           93312000
Size of each layer:   9331200
Total gap size:       74069847 -&gt; 79 %
Maximum gap size:     87 % on 2002-06-06
Minimum gap size:     75 % on 2002-08-01
Value range:          222.99 - 339.32
</code></pre></div>
<p>Utiliting the get_gap_heat_map the amount of missing values over time can be computed for every latitude/longitude pixel:</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">ml4xcube.plotting</span> <span class="kn">import</span> <span class="n">plot_slice</span>
<span class="kn">from</span> <span class="nn">ml4xcube.insights</span> <span class="kn">import</span> <span class="n">get_gap_heat_map</span>

<span class="c1"># Load sample data</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_zarr</span><span class="p">(</span><span class="s1">&#39;sample_data.zarr&#39;</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span>

<span class="c1"># Generate and visualize the gap heat map</span>
<span class="n">gap_heat_map</span> <span class="o">=</span> <span class="n">get_gap_heat_map</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<span class="n">dataset</span>   <span class="o">=</span> <span class="n">gap_heat_map</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;temperature&#39;</span><span class="p">)</span>

<span class="n">plot_slice</span><span class="p">(</span>
    <span class="n">ds</span>          <span class="o">=</span> <span class="n">dataset</span><span class="p">,</span>
    <span class="n">var_to_plot</span> <span class="o">=</span> <span class="s1">&#39;temperature&#39;</span><span class="p">,</span> 
    <span class="n">color_map</span>   <span class="o">=</span> <span class="s2">&quot;plasma&quot;</span><span class="p">,</span>
    <span class="n">title</span>       <span class="o">=</span> <span class="s2">&quot;Filled artificial gaps matrix&quot;</span><span class="p">,</span>
    <span class="n">label</span>       <span class="o">=</span> <span class="s2">&quot;Number of gaps&quot;</span><span class="p">,</span>
    <span class="n">xdim</span>        <span class="o">=</span> <span class="s2">&quot;lon&quot;</span><span class="p">,</span>
    <span class="n">ydim</span>        <span class="o">=</span> <span class="s2">&quot;lat&quot;</span>
<span class="p">)</span>
</code></pre></div>
Running this example results in an the following illustration, showing a heatmap of data gaps in the land surface temperature 
variable over time. The number of available data ranges from 0 to 10, corresponding to the 10 frames in the analyzed cube:</p>
<p align="center">
    <img src="../heatmap.png" alt="Gap Heat Map" width="70%">
</p>
<p align = "center"><i>
<strong>Heatmap of available data in the land surface temperature variable over time.</strong></i>
</p>

<h3 id="5-gapfilling">5. Gapfilling<a class="headerlink" href="#5-gapfilling" title="Permanent link">#</a></h3>
<p>The gapfilling module provides a method for filling gaps in ESDCs, particularly tailored for remote sensing datasets 
(Sarafanov et al. 2020). This approach utilizes a support vector regression model to predict missing values based 
on available data. </p>
<p>After examining the amount of missing values in the cube, the module can be applied to fill the corresponding 
areas in the cube as showcased in the following example:</p>
<h4 id="demo-notebook_2">Demo Notebook<a class="headerlink" href="#demo-notebook_2" title="Permanent link">#</a></h4>
<ol>
<li><a href="https://github.com/deepesdl/ML-Toolkits/blob/master/Examples/gapfilling_process.ipynb">Gap Filling Process</a>. </li>
</ol>
<h3 id="6-predictions-for-multidimensional-samples">6. Predictions for Multidimensional Samples<a class="headerlink" href="#6-predictions-for-multidimensional-samples" title="Permanent link">#</a></h3>
<p>An alternative to <a href="#5-gapfilling">gap filling</a> can be using simpler methods. For example, missing values can be imputed 
by replacing them with the mean or a constant placeholder. After exploring the data, it might be evident that gaps 
are not frequent. In some cases, in environmental modeling for specific regions, missing values may be intentional.
For instance, values may appear only in terrestrial regions.</p>
<p>In such scenarios, data imputation can enable the effective use of the entire dataset, allowing for model training and analysis without the complications of incomplete data.</p>
<p>The following notebooks demonstrate the workflow for land surface temperature prediction using multidimensional data with missing values.</p>
<h4 id="demo-notebooks_1">Demo Notebooks<a class="headerlink" href="#demo-notebooks_1" title="Permanent link">#</a></h4>
<ol>
<li><a href="https://github.com/deepesdl/ML-Toolkits/blob/master/Examples/use_case_lst_pytorch_nd.ipynb">Machine Learning for Multidimensional Samples (PyTorch)</a>. </li>
<li><a href="https://github.com/deepesdl/ML-Toolkits/blob/master/Examples/use_case_lst_tensorflow_nd.ipynb">Machine Learning for Multidimensional Samples (TensorFlow)</a>. </li>
</ol>
<p align="center">
<img src="../replace_gaps.png" width="60%" height="60%">
</p>
<p align = "center"><i>
<strong>Filling areas outside the continent with constant value.</strong></i>
</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2025 by the DeepESDL Team
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.top", "navigation.indexes", "toc.permalink", "toc.follow"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../javascript/mkapi.js"></script>
      
    
  </body>
</html>